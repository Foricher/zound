@()

@main("ZOUND") {


    <section id="channels">

      <header>
        <h1>ZOUND</h1>
      </header>

      @Range(0, 3).map { i =>
        <div class="channel" id="channel@i">
          <div class="head">
            <h2>Chan @i</h2>
          </div>
            <div class="sound-onoff">
              <div class="field">
                <input id="ch@i-switch-on" type="radio" name="ch@i-on" value="sound-on" />
                <label for="ch@i-switch-on">On</label>
              </div>
              <div class="field">
                <input id="ch@i-switch-off" type="radio" name="ch@i-on" value="sound-off" />
                <label for="ch@i-switch-off">Off</label>
              </div>
            </div>
            <div>
              <div class="field">
                <input id="ch@i-wave-sine" type="radio" name="ch@i-wave" value="wave-sine" /> 
                <label for="ch@i-wave-sine">Sine</label>
              </div>
              <div class="field">
                <input id="ch@i-wave-saw" type="radio" name="ch@i-wave" value="wave-saw" /> 
                <label for="ch@i-wave-saw">Saw</label>
              </div>
                <br/>
              <div class="field">
                <input id="ch@i-wave-pulse" type="radio" name="ch@i-wave" value="wave-pulse" /> 
                <label for="ch@i-wave-pulse">Pulse</label>
              </div>
              <div class="field">
                <input id="ch@i-wave-noise" type="radio" name="ch@i-wave" value="wave-noise" /> 
                <label for="ch@i-wave-noise">Noise</label>
              </div>
            </div>
            <div class="sound-freq">
              @for( (name, freq) <- List(
                ("C-1", 164.8),
                ("E-1", 196.0),
                ("G-1", 261.6),
                ("C-2", 329.6),
                ("E-3", 392.0),
                ("G-2", 523.2)
                )) {
              <div class="field">
                <input id="ch@i-note-@name" type="radio" name="ch@i-note" value="@freq" /> 
                <label for="ch@i-note-@name">@name</label>
              </div>
              }
            </div>
          </div>
          }
      </section>

      <div id="controls">
        <audio src="/stream.wav?t=@(new java.util.Date().getTime)" preload autoplay controls></audio>
      </div>

      <div style="display: none" class="images">
        <img src="/assets/images/radio.png" alt="" />
        <img src="/assets/images/radio-checked.png" alt="" />
      </div>

    <script type="text/javascript" charset="utf-8">
        $(".sound-onoff input").click(function(e){
            var $this = $(this),
                chan = parseInt($this.parents("div.channel:first").attr("id").replace(/[^0-9]/g, ""), 10),
                onOff = $this.val().replace("sound-", "");
            $.post("/osc/" + chan + "/" + onOff);
        });


        $(".sound-freq input").click(function(e){
            var $this = $(this),
                chan = parseInt($this.parents("div.channel:first").attr("id").replace(/[^0-9]/g, ""), 10),
                freq = $this.val();
            $.post("/osc/" + chan + "/freq/" + freq);
        });

        $(".sound-wave input").click(function(e){
            var $this = $(this),
                chan = parseInt($this.parents("div.channel:first").attr("id").replace(/[^0-9]/g, ""), 10),
                wave = $this.val().replace("wave-", "");
            $.post("/osc/" + chan + "/wave/" + wave);
        })
    </script>
}
